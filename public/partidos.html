<!DOCTYPE html>
<html lang="es">

<head>
  <!-- Meta datos esenciales para página de partidos del Torneo Juvenil La Pradera -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Partidos y Resultados - Torneo Juvenil La Pradera</title>
  <meta name="description"
    content="Consulta la programación, resultados y horarios de todos los partidos del Torneo Juvenil La Pradera. Vive el minuto a minuto, conoce las jornadas, equipos y estados de cada encuentro." />
  <meta name="keywords"
    content="partidos, calendario, fútbol juvenil, Torneo La Pradera, resultados, horarios, equipos, fechas, fixture, programación, jornadas, goles, estados de partido" />
  <meta name="author" content="Organización Torneo Juvenil La Pradera">
  <meta name="robots" content="index, follow">
  <meta name="theme-color" content="#0082C9">

  <!-- Open Graph (Facebook, WhatsApp, LinkedIn) -->
  <meta property="og:title" content="Partidos y Resultados - Torneo Juvenil La Pradera">
  <meta property="og:description"
    content="Programación actualizada, resultados y horarios de los partidos del Torneo Juvenil La Pradera. Consulta equipos, jornadas y sigue tu equipo favorito.">
  <meta property="og:image" content="https://torneo-juvenil.vercel.app/images/EscudoTorneo.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="https://torneo-juvenil.vercel.app/partidos">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="es_CO">
  <meta property="og:site_name" content="Torneo Juvenil La Pradera">

  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Partidos y Resultados - Torneo Juvenil La Pradera">
  <meta name="twitter:description"
    content="Descubre la programación y resultados de los partidos del Torneo Juvenil La Pradera. Todos los datos en tiempo real.">
  <meta name="twitter:image" content="https://torneo-juvenil.vercel.app/images/EscudoTorneo.png">
  <meta name="twitter:site" content="@TuUsuarioTwitter"> <!-- (Opcional: tu usuario) -->

  <!-- Iconos para navegadores y apps -->
  <link rel="icon" href="https://torneo-juvenil.vercel.app/images/EscudoTorneo.png" type="image/png">
  <link rel="apple-touch-icon" href="https://torneo-juvenil.vercel.app/images/EscudoTorneo.png" sizes="180x180">

  <!-- Canonical URL para SEO -->
  <link rel="canonical" href="https://torneo-juvenil.vercel.app/partidos">

  <!-- Librerías y estilos extra -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="shortcut icon" href="images/EscudoTorneo.png" type="image/x-icon">
  <link rel="stylesheet" href="style/style.css" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: #f5f8ff;
    }

    main {
      min-height: 80vh;
    }

    .partido-card {
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 2px 12px #0001;
      padding: 1.2rem 1.5rem;
      margin-bottom: 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: box-shadow 0.2s;
    }

    .partido-card:hover {
      box-shadow: 0 4px 24px #0002;
    }

    .equipos {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .equipo-nombre {
      font-size: 1.3rem;
      font-weight: 600;
      color: #182347;
      margin-bottom: 0.3rem;
      display: flex;
      align-items: center;
      gap: 0.5em;
    }

    .vs {
      color: #4e64fa;
      font-weight: bold;
      margin: 0.4em 0;
    }

    .partido-hora {
      font-size: 1.15rem;
      color: #2535b8;
      font-weight: 700;
      text-align: right;
    }

    .badge {
      font-size: 90%;
      vertical-align: middle;
      margin-left: .5em;
    }

    .partido-btn {
      margin-top: 0.75em;
      pointer-events: none;
    }

    @media (max-width: 600px) {
      .partido-card {
        flex-direction: column;
        align-items: flex-start;
      }

      .partido-hora {
        align-self: flex-end;
        margin-bottom: 1em;
      }
    }
  </style>
</head>

<body>
  <!-- NAVBAR, HERO Y FOOTER INCLUÍDOS EXTERNAMENTE -->
  <div id="nav-placeholder"></div>
  <div id="hero-placeholder"></div>

  <main>
    <div class="container py-4 mb-5">
      <h2 class="mb-4 fw-bold text-primary">Partidos y Resultados</h2>
      <div id="partidosList"></div>
    </div>
  </main>

  <div id="footer-placeholder"></div>

  <!-- SUPABASE Y JS -->
  <script type="module">
    import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

    const supabaseUrl = "https://cwlvpzossqmpuzdpjrsh.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN3bHZwem9zc3FtcHV6ZHBqcnNoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE0MDc5NTIsImV4cCI6MjA3Njk4Mzk1Mn0.PPq8uCEx9Tu1B6iBtS2eCHogGSRaxc5tWPF8PZnU-Go";
    const supabase = createClient(supabaseUrl, supabaseKey);

    function claseEstado(estado = "") {
      switch (estado.toUpperCase()) {
        case "FINALIZADO": return "badge bg-success text-white";
        case "OTORGADO": return "badge bg-warning text-dark";
        case "PROGRAMADO": return "badge bg-info text-dark";
        case "EN JUEGO": return "badge bg-primary text-white";
        case "CANCELADO": return "badge bg-danger text-white";
        default: return "badge bg-secondary text-white";
      }
    }
    function formatearFecha(fechaISO) {
      try {
        return fechaISO ? new Date(fechaISO).toLocaleDateString('es-CO', { weekday: 'long', year: 'numeric', month: 'short', day: 'numeric' }) : "-";
      } catch { return "-"; }
    }
    function partidoCard(p) {
      const hora = p.hora || "-";
      const fecha = formatearFecha(p.fecha);
      const estadoHtml = `<span class="${claseEstado(p.estado)} fw-bold">${p.estado || '—'}</span>`;
      const resultado = (p.goles_local !== null && p.goles_visitante !== null)
        ? `<span class="text-danger">${p.goles_local}</span> - <span class="text-primary">${p.goles_visitante}</span>`
        : `<span class="vs">VS</span>`;
      return `
        <div class="partido-card">
          <div class="equipos">
            <div class="equipo-nombre">${p.equipo_local}</div>
            ${resultado}
            <div class="equipo-nombre">${p.equipo_visitante}</div>
            <div class="text-secondary small">${fecha} ${estadoHtml}</div>
          </div>
          <div class="partido-hora">
            ${hora}
            <br>
            <button class="btn btn-outline-primary btn-sm partido-btn" type="button" disabled>Ver detalles</button>
          </div>
        </div>
      `;
    }
    async function cargarPartidos() {
      const el = document.getElementById("partidosList");
      el.innerHTML = '<div class="my-5 text-center text-muted">Cargando partidos...</div>';
      const { data, error } = await supabase
        .from("vista_resultados")
        .select("*")
        .order("jornada", { ascending: true })
        .order("fecha", { ascending: true })
        .order("hora", { ascending: true });

      if (error || !data) {
        el.innerHTML = `<div class="alert alert-danger">Error al cargar partidos</div>`;
        return;
      }
      if (data.length === 0) {
        el.innerHTML = `<div class="alert alert-info">No hay partidos por mostrar</div>`;
        return;
      }
      el.innerHTML = data.map(partidoCard).join('');
    }

    document.addEventListener("DOMContentLoaded", cargarPartidos);
  </script>

  <!-- INCLUDES DE COMPONENTES EXTERNOS -->
  <script>
    Promise.all([
      fetch('layout/navbar.html').then(r => r.text()).then(h => { document.getElementById('nav-placeholder').innerHTML = h; }),
      fetch('layout/hero.html').then(r => r.text()).then(h => { document.getElementById('hero-placeholder').innerHTML = h; }),
      fetch('layout/footer.html').then(r => r.text()).then(h => { document.getElementById('footer-placeholder').innerHTML = h; })
    ]).catch(console.error);
  </script>
</body>

</html>